<%- include('../shared/header') %>

<div class="max-w-5xl mx-auto mt-10 bg-white p-6 shadow rounded">
  <h1 class="text-2xl font-bold text-blue-600 mb-4">My Appointments</h1>

  <% if (!appointments || appointments.length === 0) { %>
    <p class="text-gray-600">No appointments booked yet.</p>
  <% } else { %>
    <table class="w-full border border-gray-300">
      <thead class="bg-blue-500 text-white">
        <tr>
          <th class="p-2 text-left">Doctor</th>
          <th class="p-2 text-left">Specialization</th>
          <th class="p-2 text-left">Date & Time</th>
          <th class="p-2 text-left">Status</th>
          <th class="p-2 text-left">Meeting Link</th>
        </tr>
      </thead>
      <tbody>
        <% appointments.forEach(app => { %>
          <tr class="border-b hover:bg-gray-50">
            <td class="p-2"><%= app.doctorId ? app.doctorId.name : 'Doctor deleted' %></td>
            <td class="p-2"><%= app.doctorId ? app.doctorId.specialization : '-' %></td>
            <td class="p-2"><%= app.date %></td>
            <td class="p-2">
              <% if (app.status === 'Pending') { %>
                <span class="text-yellow-500 font-semibold">Pending</span>
              <% } else if (app.status === 'Approved') { %>
                <span class="text-green-600 font-semibold">Approved</span>
              <% } else { %>
                <span class="text-red-500 font-semibold">Cancelled</span>
              <% } %>
            </td>
            <td class="p-2">
              <% if (app.status === 'Approved' && app.meetingLink) { %>
                <a href="<%= app.meetingLink %>" target="_blank" class="text-blue-600 underline">Join Meeting</a>
              <% } else if (app.status === 'Approved') { %>
                <span class="text-gray-500">Waiting for link</span>
              <% } else { %>
                <span class="text-gray-400">N/A</span>
              <% } %>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  <% } %>
</div>

<%- include('../shared/footer') %>
